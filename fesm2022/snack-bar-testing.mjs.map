{"version":3,"file":"snack-bar-testing.mjs","sources":["../../../../../k8-fastbuild-ST-199a4f3c4e20/bin/src/material/snack-bar/testing/snack-bar-harness.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {ContentContainerComponentHarness, HarnessPredicate, parallel} from '@angular/cdk/testing';\nimport {AriaLivePoliteness} from '@angular/cdk/a11y';\nimport {SnackBarHarnessFilters} from './snack-bar-harness-filters';\n\n/** Harness for interacting with a mat-snack-bar in tests. */\nexport class MatSnackBarHarness extends ContentContainerComponentHarness<string> {\n  // Developers can provide a custom component or template for the\n  // snackbar. The canonical snack-bar parent is the \"MatSnackBarContainer\".\n  /** The selector for the host element of a `MatSnackBar` instance. */\n  static hostSelector = '.mat-mdc-snack-bar-container:not([mat-exit])';\n  private _messageSelector = '.mdc-snackbar__label';\n  private _actionButtonSelector = '.mat-mdc-snack-bar-action';\n\n  private _snackBarLiveRegion = this.locatorFor('[aria-live]');\n\n  /**\n   * Gets a `HarnessPredicate` that can be used to search for a `MatSnackBarHarness` that meets\n   * certain criteria.\n   * @param options Options for filtering which snack bar instances are considered a match.\n   * @return a `HarnessPredicate` configured with the given options.\n   */\n  static with(options: SnackBarHarnessFilters = {}): HarnessPredicate<MatSnackBarHarness> {\n    return new HarnessPredicate(MatSnackBarHarness, options);\n  }\n\n  /**\n   * Gets the role of the snack-bar. The role of a snack-bar is determined based\n   * on the ARIA politeness specified in the snack-bar config.\n   * @deprecated Use `getAriaLive` instead.\n   * @breaking-change 13.0.0\n   */\n  async getRole(): Promise<'alert' | 'status' | null> {\n    return (await this.host()).getAttribute('role') as Promise<'alert' | 'status' | null>;\n  }\n\n  /**\n   * Gets the aria-live of the snack-bar's live region. The aria-live of a snack-bar is\n   * determined based on the ARIA politeness specified in the snack-bar config.\n   */\n  async getAriaLive(): Promise<AriaLivePoliteness> {\n    return (await this._snackBarLiveRegion()).getAttribute(\n      'aria-live',\n    ) as Promise<AriaLivePoliteness>;\n  }\n\n  /**\n   * Whether the snack-bar has an action. Method cannot be used for snack-bar's with custom content.\n   */\n  async hasAction(): Promise<boolean> {\n    return (await this._getActionButton()) !== null;\n  }\n\n  /**\n   * Gets the description of the snack-bar. Method cannot be used for snack-bar's without action or\n   * with custom content.\n   */\n  async getActionDescription(): Promise<string> {\n    await this._assertHasAction();\n    return (await this._getActionButton())!.text();\n  }\n\n  /**\n   * Dismisses the snack-bar by clicking the action button. Method cannot be used for snack-bar's\n   * without action or with custom content.\n   */\n  async dismissWithAction(): Promise<void> {\n    await this._assertHasAction();\n    await (await this._getActionButton())!.click();\n  }\n\n  /**\n   * Gets the message of the snack-bar. Method cannot be used for snack-bar's with custom content.\n   */\n  async getMessage(): Promise<string> {\n    return (await this.locatorFor(this._messageSelector)()).text();\n  }\n\n  /** Gets whether the snack-bar has been dismissed. */\n  async isDismissed(): Promise<boolean> {\n    // We consider the snackbar dismissed if it's not in the DOM. We can assert that the\n    // element isn't in the DOM by seeing that its width and height are zero.\n\n    const host = await this.host();\n    const [exit, dimensions] = await parallel(() => [\n      // The snackbar container is marked with the \"exit\" attribute after it has been dismissed\n      // but before the animation has finished (after which it's removed from the DOM).\n      host.getAttribute('mat-exit'),\n      host.getDimensions(),\n    ]);\n\n    return exit != null || (!!dimensions && dimensions.height === 0 && dimensions.width === 0);\n  }\n\n  /**\n   * Asserts that the current snack-bar has an action defined. Otherwise the\n   * promise will reject.\n   */\n  private async _assertHasAction(): Promise<void> {\n    if (!(await this.hasAction())) {\n      throw Error('Method cannot be used for a snack-bar without an action.');\n    }\n  }\n\n  /** Gets the simple snack bar action button. */\n  private async _getActionButton() {\n    return this.locatorForOptional(this._actionButtonSelector)();\n  }\n}\n"],"names":["MatSnackBarHarness","ContentContainerComponentHarness","hostSelector","_messageSelector","_actionButtonSelector","_snackBarLiveRegion","locatorFor","with","options","HarnessPredicate","getRole","host","getAttribute","getAriaLive","hasAction","_getActionButton","getActionDescription","_assertHasAction","text","dismissWithAction","click","getMessage","isDismissed","exit","dimensions","parallel","getDimensions","height","width","Error","locatorForOptional"],"mappings":";;AAaM,MAAOA,kBAAmB,SAAQC,gCAAwC,CAAA;EAI9E,OAAOC,YAAY,GAAG,8CAA8C;AAC5DC,EAAAA,gBAAgB,GAAG,sBAAsB;AACzCC,EAAAA,qBAAqB,GAAG,2BAA2B;AAEnDC,EAAAA,mBAAmB,GAAG,IAAI,CAACC,UAAU,CAAC,aAAa,CAAC;AAQ5D,EAAA,OAAOC,IAAIA,CAACC,OAAA,GAAkC,EAAE,EAAA;AAC9C,IAAA,OAAO,IAAIC,gBAAgB,CAACT,kBAAkB,EAAEQ,OAAO,CAAC;AAC1D;EAQA,MAAME,OAAOA,GAAA;IACX,OAAO,CAAC,MAAM,IAAI,CAACC,IAAI,EAAE,EAAEC,YAAY,CAAC,MAAM,CAAuC;AACvF;EAMA,MAAMC,WAAWA,GAAA;IACf,OAAO,CAAC,MAAM,IAAI,CAACR,mBAAmB,EAAE,EAAEO,YAAY,CACpD,WAAW,CACmB;AAClC;EAKA,MAAME,SAASA,GAAA;IACb,OAAO,CAAC,MAAM,IAAI,CAACC,gBAAgB,EAAE,MAAM,IAAI;AACjD;EAMA,MAAMC,oBAAoBA,GAAA;AACxB,IAAA,MAAM,IAAI,CAACC,gBAAgB,EAAE;IAC7B,OAAO,CAAC,MAAM,IAAI,CAACF,gBAAgB,EAAE,EAAGG,IAAI,EAAE;AAChD;EAMA,MAAMC,iBAAiBA,GAAA;AACrB,IAAA,MAAM,IAAI,CAACF,gBAAgB,EAAE;IAC7B,MAAM,CAAC,MAAM,IAAI,CAACF,gBAAgB,EAAE,EAAGK,KAAK,EAAE;AAChD;EAKA,MAAMC,UAAUA,GAAA;AACd,IAAA,OAAO,CAAC,MAAM,IAAI,CAACf,UAAU,CAAC,IAAI,CAACH,gBAAgB,CAAC,EAAE,EAAEe,IAAI,EAAE;AAChE;EAGA,MAAMI,WAAWA,GAAA;AAIf,IAAA,MAAMX,IAAI,GAAG,MAAM,IAAI,CAACA,IAAI,EAAE;IAC9B,MAAM,CAACY,IAAI,EAAEC,UAAU,CAAC,GAAG,MAAMC,QAAQ,CAAC,MAAM,CAG9Cd,IAAI,CAACC,YAAY,CAAC,UAAU,CAAC,EAC7BD,IAAI,CAACe,aAAa,EAAE,CACrB,CAAC;AAEF,IAAA,OAAOH,IAAI,IAAI,IAAI,IAAK,CAAC,CAACC,UAAU,IAAIA,UAAU,CAACG,MAAM,KAAK,CAAC,IAAIH,UAAU,CAACI,KAAK,KAAK,CAAE;AAC5F;EAMQ,MAAMX,gBAAgBA,GAAA;IAC5B,IAAI,EAAE,MAAM,IAAI,CAACH,SAAS,EAAE,CAAC,EAAE;MAC7B,MAAMe,KAAK,CAAC,0DAA0D,CAAC;AACzE;AACF;EAGQ,MAAMd,gBAAgBA,GAAA;IAC5B,OAAO,IAAI,CAACe,kBAAkB,CAAC,IAAI,CAAC1B,qBAAqB,CAAC,EAAE;AAC9D;;;;;"}